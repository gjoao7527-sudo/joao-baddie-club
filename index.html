<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Treino BJ</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#000000"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"SF Pro",sans-serif;
  background:#000;
  color:#fff;
  padding:20px;
}

h1{
  text-align:center;
  font-weight:600;
  margin-bottom:30px;
}

.card{
  background:#111;
  border-radius:28px;
  padding:20px;
  margin-bottom:25px;
  box-shadow:0 10px 40px rgba(255,255,255,0.05);
  animation:fade 0.4s ease;
}

@keyframes fade{
  from{opacity:0; transform:translateY(10px);}
  to{opacity:1; transform:translateY(0);}
}

.day{
  padding:14px;
  border-radius:18px;
  background:#1a1a1a;
  margin-bottom:10px;
  cursor:pointer;
  transition:0.2s;
}

.day:hover{ background:#222; }

.exercise{
  display:flex;
  justify-content:space-between;
  padding:10px 0;
  border-bottom:1px solid #222;
  transition:0.2s;
}

.exercise input{
  transform:scale(1.2);
}

.done{
  text-decoration:line-through;
  opacity:0.4;
}

.progressBar{
  height:8px;
  background:#222;
  border-radius:10px;
  overflow:hidden;
  margin:15px 0;
}

.progressFill{
  height:100%;
  background:#fff;
  width:0%;
  transition:0.3s;
}

button{
  background:#fff;
  color:#000;
  border:none;
  padding:8px 14px;
  border-radius:20px;
  font-weight:500;
  cursor:pointer;
  margin-top:10px;
}

select{
  background:#1a1a1a;
  color:#fff;
  border:none;
  padding:8px;
  border-radius:12px;
  margin-top:10px;
}

.timer{
  font-size:24px;
  margin-top:10px;
  font-weight:600;
}
</style>
</head>

<body>

<h1>Treino BJ</h1>

<div class="card">
<h2>Meta de Peso</h2>
<input type="number" id="peso" placeholder="Peso atual">
<button onclick="salvarPeso()">Salvar</button>
<canvas id="grafico"></canvas>
</div>

<div class="card">
<h2>Treinos</h2>

<div class="day" onclick="abrirTreino('gluteo')">Segunda – Glúteo</div>
<div class="day" onclick="abrirTreino('costas')">Terça – Costas + Bíceps</div>
<div class="day" onclick="abrirTreino('posterior')">Quarta – Posterior + Glúteo</div>
<div class="day" onclick="abrirTreino('ombro')">Quinta – Ombro</div>
<div class="day" onclick="abrirTreino('quad')">Sexta – Quadríceps + Glúteo</div>

<div id="treinoBox" style="margin-top:20px;"></div>

</div>

<div class="card">
<h2>Histórico</h2>
<div id="historico"></div>
</div>

<script>
if ('serviceWorker' in navigator) {
  navigator.serviceWorker.register('service-worker.js');
}

let pesos = JSON.parse(localStorage.getItem("pesos")) || [];
let progresso = JSON.parse(localStorage.getItem("progresso")) || {};
let historico = JSON.parse(localStorage.getItem("historico")) || {};
let intervalo;
let tempo = 60;

function salvarPeso(){
  let peso = document.getElementById("peso").value;
  let data = new Date().toLocaleDateString();
  pesos.push({data,peso});
  localStorage.setItem("pesos", JSON.stringify(pesos));
  atualizarGrafico();
}

function atualizarGrafico(){
  let ctx = document.getElementById('grafico');
  new Chart(ctx,{
    type:'line',
    data:{
      labels:pesos.map(p=>p.data),
      datasets:[{
        label:'Peso',
        data:pesos.map(p=>p.peso),
        borderColor:'#fff'
      }]
    }
  });
}

function abrirTreino(tipo){

  let treinos = {
    gluteo:["Elevação pélvica","Elevação unilateral","Cadeira abdutora","Glúteo no cabo","Afundo"],
    costas:["Puxada frontal","Remada baixa","Remada unilateral","Rosca direta","Rosca alternada","Rosca martelo"],
    posterior:["Stiff","Mesa flexora","Passada","Glúteo 4 apoios","Elevação pélvica","Abdutora"],
    ombro:["Elevação lateral","Desenvolvimento","Elevação frontal","Face pull","Crucifixo inverso","Remada alta"],
    quad:["Agachamento","Leg press","Cadeira extensora","Afundo búlgaro","Agachamento sumô","Abdutora"]
  };

  let box = document.getElementById("treinoBox");
  box.innerHTML = `<h3>${tipo.toUpperCase()}</h3>
  <div class="progressBar"><div id="progress" class="progressFill"></div></div>`;

  treinos[tipo].forEach((ex,i)=>{
    let checked = progresso[tipo+"-"+i] ? "checked" : "";
    let doneClass = progresso[tipo+"-"+i] ? "done" : "";

    box.innerHTML += `
      <div class="exercise ${doneClass}">
        <span>${ex}</span>
        <input type="checkbox" ${checked}
        onchange="marcar('${tipo}-${i}',this,'${tipo}',${treinos[tipo].length})">
      </div>
    `;
  });

  box.innerHTML += `
    <h4 style="margin-top:20px;">Cardio</h4>
    <select>
      <option>HIIT</option>
      <option>Esteira</option>
    </select>

    <h4>Descanso</h4>
    <div class="timer" id="timer">01:00</div>
    <button onclick="iniciarTimer()">Iniciar</button>
  `;

  atualizarProgresso(tipo, treinos[tipo].length);
}

function marcar(id,checkbox,tipo,total){
  if(checkbox.checked){
    progresso[id]=true;
  } else {
    delete progresso[id];
  }
  localStorage.setItem("progresso", JSON.stringify(progresso));
  atualizarProgresso(tipo,total);

  if(Object.keys(progresso).filter(k=>k.startsWith(tipo)).length===total){
    historico[new Date().toLocaleDateString()+" - "+tipo]="Concluído";
    localStorage.setItem("historico", JSON.stringify(historico));
    atualizarHistorico();
  }
}

function atualizarProgresso(tipo,total){
  let feitos = Object.keys(progresso).filter(k=>k.startsWith(tipo)).length;
  let porcent = (feitos/total)*100;
  document.getElementById("progress").style.width = porcent+"%";
}

function atualizarHistorico(){
  let h = document.getElementById("historico");
  h.innerHTML="";
  for(let dia in historico){
    h.innerHTML += `<div style="padding:5px 0;opacity:0.7;">${dia}</div>`;
  }
}

function iniciarTimer(){
  clearInterval(intervalo);
  tempo = 60;
  intervalo = setInterval(()=>{
    tempo--;
    let min = String(Math.floor(tempo/60)).padStart(2,'0');
    let seg = String(tempo%60).padStart(2,'0');
    document.getElementById("timer").innerText = min+":"+seg;
    if(tempo<=0){
      clearInterval(intervalo);
    }
  },1000);
}

atualizarGrafico();
atualizarHistorico();
</script>

</body>
</html>
